from secrets import a, b, flag
import hashlib
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad

p = [681543884011150930768961922854053280433615446729374352561615907312835005292745687041,
    752741409390173984831599011653950570691471611909306359687837913697615768762522880001,
    116864385956642418554171505604133067136408142787743014608748021127851655395518873601, 
    3384131839680033154854204152885768640559819439473258859327859423613730591521222010881, 
    1013615826370776414397993947224910062147569709753968149707613653518124496881664000001, 
    5785917640249194060984361645028298674037731738927708910900383740818516512106017218561, 
    2597916245537340518901621353916695020055693973693763746965993182174812509753425920001, 
    5913084779337356005990329515757372917207297211168887075319343717360787539774254366721, 
    83548367779671430260706738778914099953263091875038106592330905629140524612196900001]

P = 121161317154230196716866823126003663811172188079653847395968001886235693501184001

for i in p:
  P*=i

g = 5

A = pow(g, a, P)
B = pow(g, b, P)

S = pow(A, b, P)

key = hashlib.sha256(str(S).encode()).digest() 
cipher = AES.new(key, AES.MODE_ECB) 
encrypted_data = cipher.encrypt(pad(flag.encode(), AES.block_size)) 

out = "A = {0} \nB = {1} \nP = {2} \nCipherText = {3} \n".format(A,B,P,encrypted_data.hex())
open('output.txt','w').write(out)